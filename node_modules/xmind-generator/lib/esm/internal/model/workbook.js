import { Sheet } from "./sheet.js";
export class Workbook {
  _sheets;
  constructor(sheets) {
    this._sheets = sheets ?? [];
  }
  get sheets() {
    return this._sheets;
  }
  query(topicId) {
    for (const sheet of this._sheets) {
      const result = sheet.query(topicId);
      if (result) {
        return result;
      }
    }
    return null;
  }
  createRoot(title) {
    const sheetName = `Map ${this.sheets.length + 1}`;
    return this.addSheet(sheetName).addRootTopic(title);
  }
  addSheet(title) {
    const sheet = new Sheet(title);
    this._sheets.push(sheet);
    return sheet;
  }
  getSheet(sheetId) {
    return this.sheets.find((sheet) => sheet.id === sheetId) ?? null;
  }
}
